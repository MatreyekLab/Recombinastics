if(substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x])
if(substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x])
substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x])
substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x])
if(substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x])
if(substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x])
if(substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x])
substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x]))
substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x]))
if(substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x])
if(substr(temp_ace2_seq, as.numeric(pdb7w9i$donor_pos[x]), as.numeric(pdb7w9i$donor_pos[x])) == pdb7w9i$donor_aa1[x]){pdb7w9i$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7w9i$donor_pos[x]), as.numeric(pdb7w9i$donor_pos[x])) == pdb7w9i$donor_aa1[x]){pdb7w9i$donor_prot[x] <- "RBD"}
if(pdb7w9i$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x]){pdb7w9i$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x]){pdb7w9i$acceptor_prot[x] <- "RBD"}}
if(pdb7w9i$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x]){pdb7w9i$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x]){pdb7w9i$acceptor_prot[x] <- "ACE2"}}
View(pdb7w9i)
pdb7ekc <- read.csv(file = "Data/Proteintools/Proteintools_7ekc.csv")
for(x in 1:nrow(pdb7ekc)){
temp_rbd_seq <- subset(proteintools_key, pdb == "7ekc")$sequence
pdb7ekc$donor[x] <- strsplit(strsplit(pdb7ekc$donor_acceptor[x], "--")[[1]][1],"-")[[1]][1]
pdb7ekc$acceptor[x] <- strsplit(strsplit(pdb7ekc$donor_acceptor[x], "--")[[1]][2],"-")[[1]][1]
pdb7ekc$donor_aa3[x] <-  substr(pdb7ekc$donor[x],1,3)
pdb7ekc$donor_pos[x] <-  substr(pdb7ekc$donor[x],4,6)
pdb7ekc$acceptor_aa3[x] <-  substr(pdb7ekc$acceptor[x],2,4)
pdb7ekc$acceptor_pos[x] <-  substr(pdb7ekc$acceptor[x],5,7)
pdb7ekc$donor_aa1[x] <-  to_single_notation(pdb7ekc$donor_aa3[x])
pdb7ekc$acceptor_aa1[x] <-  to_single_notation(pdb7ekc$acceptor_aa3[x])
if(substr(temp_ace2_seq, as.numeric(pdb7ekc$donor_pos[x]), as.numeric(pdb7ekc$donor_pos[x])) == pdb7ekc$donor_aa1[x]){pdb7ekc$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7ekc$donor_pos[x]), as.numeric(pdb7ekc$donor_pos[x])) == pdb7ekc$donor_aa1[x]){pdb7ekc$donor_prot[x] <- "RBD"}
if(pdb7ekc$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7ekc$acceptor_pos[x]), as.numeric(pdb7ekc$acceptor_pos[x])) == pdb7ekc$acceptor_aa1[x]){pdb7ekc$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7ekc$acceptor_pos[x]), as.numeric(pdb7ekc$acceptor_pos[x])) == pdb7ekc$acceptor_aa1[x]){pdb7ekc$acceptor_prot[x] <- "RBD"}}
if(pdb7ekc$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7ekc$acceptor_pos[x]), as.numeric(pdb7ekc$acceptor_pos[x])) == pdb7ekc$acceptor_aa1[x]){pdb7ekc$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7ekc$acceptor_pos[x]), as.numeric(pdb7ekc$acceptor_pos[x])) == pdb7ekc$acceptor_aa1[x]){pdb7ekc$acceptor_prot[x] <- "ACE2"}}
}
View(pdb7ekf)
pdb7w9i <- read.csv(file = "Data/Proteintools/Proteintools_7w9i.csv")
for(x in 1:nrow(pdb7w9i)){
temp_rbd_seq <- subset(proteintools_key, pdb == "7w9i")$sequence
pdb7w9i$donor[x] <- strsplit(strsplit(pdb7w9i$donor_acceptor[x], "--")[[1]][1],"-")[[1]][1]
pdb7w9i$acceptor[x] <- strsplit(strsplit(pdb7w9i$donor_acceptor[x], "--")[[1]][2],"-")[[1]][1]
pdb7w9i$donor_aa3[x] <-  substr(pdb7w9i$donor[x],1,3)
pdb7w9i$donor_pos[x] <-  substr(pdb7w9i$donor[x],4,6)
pdb7w9i$acceptor_aa3[x] <-  substr(pdb7w9i$acceptor[x],2,4)
pdb7w9i$acceptor_pos[x] <-  substr(pdb7w9i$acceptor[x],5,7)
pdb7w9i$donor_aa1[x] <-  to_single_notation(pdb7w9i$donor_aa3[x])
pdb7w9i$acceptor_aa1[x] <-  to_single_notation(pdb7w9i$acceptor_aa3[x])
if(substr(temp_ace2_seq, as.numeric(pdb7w9i$donor_pos[x]), as.numeric(pdb7w9i$donor_pos[x])) == pdb7w9i$donor_aa1[x]){pdb7w9i$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7w9i$donor_pos[x]), as.numeric(pdb7w9i$donor_pos[x])) == pdb7w9i$donor_aa1[x]){pdb7w9i$donor_prot[x] <- "RBD"}
if(pdb7w9i$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x]){pdb7w9i$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x]){pdb7w9i$acceptor_prot[x] <- "RBD"}}
if(pdb7w9i$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x]){pdb7w9i$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x]){pdb7w9i$acceptor_prot[x] <- "ACE2"}}
}
View(pdb7w9i)
substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x])
substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x])
substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x]
substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x]
substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x]))
substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x]))
substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x]))
pdb7w9i$acceptor_aa1[x]
temp_rbd_seq
substr(temp_rbd_seq, 500,500)
substr(temp_rbd_seq, 500,502)
substr(temp_rbd_seq, 499,502)
substr(temp_rbd_seq, 498,501)
pdb7w9i <- read.csv(file = "Data/Proteintools/Proteintools_7w9i.csv")
for(x in 1:nrow(pdb7w9i)){
temp_rbd_seq <- subset(proteintools_key, pdb == "7w9i")$sequence
pdb7w9i$donor[x] <- strsplit(strsplit(pdb7w9i$donor_acceptor[x], "--")[[1]][1],"-")[[1]][1]
pdb7w9i$acceptor[x] <- strsplit(strsplit(pdb7w9i$donor_acceptor[x], "--")[[1]][2],"-")[[1]][1]
pdb7w9i$donor_aa3[x] <-  substr(pdb7w9i$donor[x],1,3)
pdb7w9i$donor_pos[x] <-  substr(pdb7w9i$donor[x],4,6)
pdb7w9i$acceptor_aa3[x] <-  substr(pdb7w9i$acceptor[x],2,4)
pdb7w9i$acceptor_pos[x] <-  substr(pdb7w9i$acceptor[x],5,7)
pdb7w9i$donor_aa1[x] <-  to_single_notation(pdb7w9i$donor_aa3[x])
pdb7w9i$acceptor_aa1[x] <-  to_single_notation(pdb7w9i$acceptor_aa3[x])
if(substr(temp_ace2_seq, as.numeric(pdb7w9i$donor_pos[x]), as.numeric(pdb7w9i$donor_pos[x])) == pdb7w9i$donor_aa1[x]){pdb7w9i$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7w9i$donor_pos[x])-2, as.numeric(pdb7w9i$donor_pos[x])-2) == pdb7w9i$donor_aa1[x]){pdb7w9i$donor_prot[x] <- "RBD"}
if(pdb7w9i$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x]){pdb7w9i$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7w9i$acceptor_pos[x])-2, as.numeric(pdb7w9i$acceptor_pos[x])-2) == pdb7w9i$acceptor_aa1[x]){pdb7w9i$acceptor_prot[x] <- "RBD"}}
if(pdb7w9i$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7w9i$acceptor_pos[x])-2, as.numeric(pdb7w9i$acceptor_pos[x])-2) == pdb7w9i$acceptor_aa1[x]){pdb7w9i$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7w9i$acceptor_pos[x]), as.numeric(pdb7w9i$acceptor_pos[x])) == pdb7w9i$acceptor_aa1[x]){pdb7w9i$acceptor_prot[x] <- "ACE2"}}
}
pdb7w9i$donor_res <- paste0(pdb7w9i$donor_aa1,pdb7w9i$donor_pos)
pdb7w9i$acceptor_res <- paste0(pdb7w9i$acceptor_aa1,pdb7w9i$acceptor_pos)
pdb7w9i_inter <- pdb7w9i %>% filter(donor_prot != acceptor_prot & !(donor_res %in% wrong_interhbond_assignments)) %>% mutate(variant = "Beta", pdb = "7w9i")
View(pdb7w9i_inter)
inter_hbond_combined <- rbind(pdb7ekf_inter[,hbond_colnames_to_join], pdb7ekg_inter[,hbond_colnames_to_join], pdb7ekc_inter[,hbond_colnames_to_join], pdb7vx4_inter[,hbond_colnames_to_join])
hbond_colnames_to_join <- c("variant","pdb","donor_res","acceptor_res","donor_acceptor","distance","dha")
inter_hbond_combined <- rbind(pdb7ekf_inter[,hbond_colnames_to_join], pdb7ekg_inter[,hbond_colnames_to_join], pdb7ekc_inter[,hbond_colnames_to_join], pdb7vx4_inter[,hbond_colnames_to_join])
View(inter_hbond_combined)
inter_hbond_combined <- rbind(pdb7ekf_inter[,hbond_colnames_to_join], pdb7ekg_inter[,hbond_colnames_to_join], pdb7ekc_inter[,hbond_colnames_to_join], pdb7vx4_inter[,hbond_colnames_to_join], pdb7w9i[,hbond_colnames_to_join])
hbond_colnames_to_join <- c("variant","pdb","donor_res","acceptor_res","donor_acceptor","distance","dha")
pdb7w9i_inter <- pdb7w9i %>% filter(donor_prot != acceptor_prot & !(donor_res %in% wrong_interhbond_assignments)) %>% mutate(variant = "Delta", pdb = "7w9i")
hbond_colnames_to_join <- c("variant","pdb","donor_res","acceptor_res","donor_acceptor","distance","dha")
inter_hbond_combined <- rbind(pdb7ekf_inter[,hbond_colnames_to_join], pdb7ekg_inter[,hbond_colnames_to_join], pdb7ekc_inter[,hbond_colnames_to_join], pdb7vx4_inter[,hbond_colnames_to_join], pdb7w9i[,hbond_colnames_to_join])
pdb7w9i$donor_res <- paste0(pdb7w9i$donor_aa1,pdb7w9i$donor_pos)
pdb7w9i$acceptor_res <- paste0(pdb7w9i$acceptor_aa1,pdb7w9i$acceptor_pos)
pdb7w9i_inter <- pdb7w9i %>% filter(donor_prot != acceptor_prot & !(donor_res %in% wrong_interhbond_assignments)) %>% mutate(variant = "Delta", pdb = "7w9i")
hbond_colnames_to_join <- c("variant","pdb","donor_res","acceptor_res","donor_acceptor","distance","dha")
inter_hbond_combined <- rbind(pdb7ekf_inter[,hbond_colnames_to_join], pdb7ekg_inter[,hbond_colnames_to_join], pdb7ekc_inter[,hbond_colnames_to_join], pdb7vx4_inter[,hbond_colnames_to_join], pdb7w9i[,hbond_colnames_to_join])
inter_hbond_combined <- rbind(pdb7ekf_inter[,hbond_colnames_to_join], pdb7ekg_inter[,hbond_colnames_to_join], pdb7ekc_inter[,hbond_colnames_to_join], pdb7vx4_inter[,hbond_colnames_to_join], pdb7w9i_inter[,hbond_colnames_to_join])
View(inter_hbond_combined)
proteintools_key <- read.csv(file = "Data/Proteintools/Proteintools_key.csv")
pdb7u0n <- read.csv(file = "Data/Proteintools/Proteintools_7u0n.csv")
for(x in 1:nrow(pdb7u0n)){
temp_rbd_seq <- subset(proteintools_key, pdb == "7u0n")$sequence
pdb7u0n$donor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][1],"-")[[1]][1]
pdb7u0n$acceptor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][2],"-")[[1]][1]
pdb7u0n$donor_aa3[x] <-  substr(pdb7u0n$donor[x],1,3)
pdb7u0n$donor_pos[x] <-  substr(pdb7u0n$donor[x],4,6)
pdb7u0n$acceptor_aa3[x] <-  substr(pdb7u0n$acceptor[x],2,4)
pdb7u0n$acceptor_pos[x] <-  substr(pdb7u0n$acceptor[x],5,7)
pdb7u0n$donor_aa1[x] <-  to_single_notation(pdb7u0n$donor_aa3[x])
pdb7u0n$acceptor_aa1[x] <-  to_single_notation(pdb7u0n$acceptor_aa3[x])
if(substr(temp_ace2_seq, as.numeric(pdb7u0n$donor_pos[x]), as.numeric(pdb7u0n$donor_pos[x])) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x]), as.numeric(pdb7u0n$donor_pos[x])) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "RBD"}
if(pdb7u0n$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"}}
if(pdb7u0n$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"}}
}
View(pdb7u0n)
substr(temp_rbd_seq,496,503)
substr(temp_rbd_seq,498,503)
substr(temp_rbd_seq,498,502)
substr(temp_rbd_seq,48,502)
substr(temp_rbd_seq,498,502)
substr(temp_rbd_seq,497,502)
substr(temp_rbd_seq,497,499)
substr(temp_rbd_seq,497,498)
pdb7u0n <- read.csv(file = "Data/Proteintools/Proteintools_7u0n.csv")
for(x in 1:nrow(pdb7u0n)){
temp_rbd_seq <- subset(proteintools_key, pdb == "7u0n")$sequence
pdb7u0n$donor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][1],"-")[[1]][1]
pdb7u0n$acceptor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][2],"-")[[1]][1]
pdb7u0n$donor_aa3[x] <-  substr(pdb7u0n$donor[x],1,3)
pdb7u0n$donor_pos[x] <-  substr(pdb7u0n$donor[x],4,6)
pdb7u0n$acceptor_aa3[x] <-  substr(pdb7u0n$acceptor[x],2,4)
pdb7u0n$acceptor_pos[x] <-  substr(pdb7u0n$acceptor[x],5,7)
pdb7u0n$donor_aa1[x] <-  to_single_notation(pdb7u0n$donor_aa3[x])
pdb7u0n$acceptor_aa1[x] <-  to_single_notation(pdb7u0n$acceptor_aa3[x])
if(substr(temp_ace2_seq, as.numeric(pdb7u0n$donor_pos[x]), as.numeric(pdb7u0n$donor_pos[x])) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "RBD"}
if(pdb7u0n$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"}}
if(pdb7u0n$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x])-3, as.numeric(pdb7u0n$acceptor_pos[x])-3) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"}}
}
substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x])-3, as.numeric(pdb7u0n$acceptor_pos[x])-3)
substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x])-3, as.numeric(pdb7u0n$acceptor_pos[x])-3)
substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x])-3, as.numeric(pdb7u0n$acceptor_pos[x])-3)
substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3
substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3)
substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3)
substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3)
substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3)
pdb7u0n$donor_aa1[x]
pdb7u0n$donor_aa1[x]
if(substr(temp_ace2_seq, as.numeric(pdb7u0n$donor_pos[x]), as.numeric(pdb7u0n$donor_pos[x])) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "RBD"}
if(pdb7u0n$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"}}
if(pdb7u0n$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x])-3, as.numeric(pdb7u0n$acceptor_pos[x])-3) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"}}
pdb7u0n <- read.csv(file = "Data/Proteintools/Proteintools_7u0n.csv")
for(x in 1:nrow(pdb7u0n)){
temp_rbd_seq <- subset(proteintools_key, pdb == "7u0n")$sequence
pdb7u0n$donor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][1],"-")[[1]][1]
pdb7u0n$acceptor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][2],"-")[[1]][1]
pdb7u0n$donor_aa3[x] <-  substr(pdb7u0n$donor[x],1,3)
pdb7u0n$donor_pos[x] <-  substr(pdb7u0n$donor[x],4,6)
pdb7u0n$acceptor_aa3[x] <-  substr(pdb7u0n$acceptor[x],2,4)
pdb7u0n$acceptor_pos[x] <-  substr(pdb7u0n$acceptor[x],5,7)
pdb7u0n$donor_aa1[x] <-  to_single_notation(pdb7u0n$donor_aa3[x])
pdb7u0n$acceptor_aa1[x] <-  to_single_notation(pdb7u0n$acceptor_aa3[x])
if(substr(temp_ace2_seq, as.numeric(pdb7u0n$donor_pos[x]), as.numeric(pdb7u0n$donor_pos[x])) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "RBD"}
if(pdb7u0n$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"}}
if(pdb7u0n$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x])-3, as.numeric(pdb7u0n$acceptor_pos[x])-3) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"}}
}
if(substr(temp_ace2_seq, as.numeric(pdb7u0n$donor_pos[x]), as.numeric(pdb7u0n$donor_pos[x])) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "RBD"}
if(pdb7u0n$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"}}
if(pdb7u0n$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x])-3, as.numeric(pdb7u0n$acceptor_pos[x])-3) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"}}
for(x in 1:nrow(pdb7u0n)){
temp_rbd_seq <- subset(proteintools_key, pdb == "7u0n")$sequence
pdb7u0n$donor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][1],"-")[[1]][1]
pdb7u0n$acceptor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][2],"-")[[1]][1]
pdb7u0n$donor_aa3[x] <-  substr(pdb7u0n$donor[x],1,3)
pdb7u0n$donor_pos[x] <-  substr(pdb7u0n$donor[x],4,6)
pdb7u0n$acceptor_aa3[x] <-  substr(pdb7u0n$acceptor[x],2,4)
pdb7u0n$acceptor_pos[x] <-  substr(pdb7u0n$acceptor[x],5,7)
pdb7u0n$donor_aa1[x] <-  to_single_notation(pdb7u0n$donor_aa3[x])
pdb7u0n$acceptor_aa1[x] <-  to_single_notation(pdb7u0n$acceptor_aa3[x])
if(substr(temp_ace2_seq, as.numeric(pdb7u0n$donor_pos[x]), as.numeric(pdb7u0n$donor_pos[x])) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "RBD"}
if(pdb7u0n$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"}}
if(pdb7u0n$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x])-3, as.numeric(pdb7u0n$acceptor_pos[x])-3) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"}}
}
View(proteintools_key)
View(pdb7u0n)
pdb7u0n <- read.csv(file = "Data/Proteintools/Proteintools_7u0n.csv")
for(x in 1:nrow(pdb7u0n)){
temp_rbd_seq <- subset(proteintools_key, pdb == "7u0n")$sequence
pdb7u0n$donor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][1],"-")[[1]][1]
pdb7u0n$acceptor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][2],"-")[[1]][1]
pdb7u0n$donor_aa3[x] <-  substr(pdb7u0n$donor[x],1,3)
pdb7u0n$donor_pos[x] <-  substr(pdb7u0n$donor[x],4,6)
pdb7u0n$acceptor_aa3[x] <-  substr(pdb7u0n$acceptor[x],2,4)
pdb7u0n$acceptor_pos[x] <-  substr(pdb7u0n$acceptor[x],5,7)
pdb7u0n$donor_aa1[x] <-  to_single_notation(pdb7u0n$donor_aa3[x])
pdb7u0n$acceptor_aa1[x] <-  to_single_notation(pdb7u0n$acceptor_aa3[x])
if(substr(temp_ace2_seq, as.numeric(pdb7u0n$donor_pos[x]), as.numeric(pdb7u0n$donor_pos[x])) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "RBD"}
if(pdb7u0n$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"}}
if(pdb7u0n$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x])-3, as.numeric(pdb7u0n$acceptor_pos[x])-3) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"}}
}
temp_rbd_seq <- subset(proteintools_key, pdb == "7u0n")$sequence
pdb7u0n$donor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][1],"-")[[1]][1]
pdb7u0n$acceptor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][2],"-")[[1]][1]
pdb7u0n$donor_aa3[x] <-  substr(pdb7u0n$donor[x],1,3)
pdb7u0n$donor_pos[x] <-  substr(pdb7u0n$donor[x],4,6)
pdb7u0n$acceptor_aa3[x] <-  substr(pdb7u0n$acceptor[x],2,4)
pdb7u0n$acceptor_pos[x] <-  substr(pdb7u0n$acceptor[x],5,7)
pdb7u0n$donor_aa1[x] <-  to_single_notation(pdb7u0n$donor_aa3[x])
pdb7u0n$acceptor_aa1[x] <-  to_single_notation(pdb7u0n$acceptor_aa3[x])
pdb7u0n$acceptor_aa1[x]
pdb7u0n$acceptor_aa1[x]
pdb7u0n$acceptor_aa3[x]
pdb7u0n$acceptor_aa3[x]
View(pdb7u0n)
substr(temp_ace2_seq,398,398)
if(toupper(arg1) == "GLH"){return("E")}
to_single_notation <- function(arg1){
if(toupper(arg1) == "ALA"){return("A")}
if(toupper(arg1) == "CYS"){return("C")}
if(toupper(arg1) == "ASP"){return("D")}
if(toupper(arg1) == "GLU"){return("E")}
if(toupper(arg1) == "GLH"){return("E")}
if(toupper(arg1) == "PHE"){return("F")}
if(toupper(arg1) == "GLY"){return("G")}
if(toupper(arg1) == "HIS"){return("H")}
if(toupper(arg1) == "ILE"){return("I")}
if(toupper(arg1) == "LYS"){return("K")}
if(toupper(arg1) == "LEU"){return("L")}
if(toupper(arg1) == "MET"){return("M")}
if(toupper(arg1) == "ASN"){return("N")}
if(toupper(arg1) == "PRO"){return("P")}
if(toupper(arg1) == "GLN"){return("Q")}
if(toupper(arg1) == "ARG"){return("R")}
if(toupper(arg1) == "SER"){return("S")}
if(toupper(arg1) == "THR"){return("T")}
if(toupper(arg1) == "VAL"){return("V")}
if(toupper(arg1) == "TRP"){return("W")}
if(toupper(arg1) == "TYR"){return("Y")}
if(toupper(arg1) == "TER"){return("X")}
}
pdb7u0n <- read.csv(file = "Data/Proteintools/Proteintools_7u0n.csv")
for(x in 1:nrow(pdb7u0n)){
temp_rbd_seq <- subset(proteintools_key, pdb == "7u0n")$sequence
pdb7u0n$donor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][1],"-")[[1]][1]
pdb7u0n$acceptor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][2],"-")[[1]][1]
pdb7u0n$donor_aa3[x] <-  substr(pdb7u0n$donor[x],1,3)
pdb7u0n$donor_pos[x] <-  substr(pdb7u0n$donor[x],4,6)
pdb7u0n$acceptor_aa3[x] <-  substr(pdb7u0n$acceptor[x],2,4)
pdb7u0n$acceptor_pos[x] <-  substr(pdb7u0n$acceptor[x],5,7)
pdb7u0n$donor_aa1[x] <-  to_single_notation(pdb7u0n$donor_aa3[x])
pdb7u0n$acceptor_aa1[x] <-  to_single_notation(pdb7u0n$acceptor_aa3[x])
if(substr(temp_ace2_seq, as.numeric(pdb7u0n$donor_pos[x]), as.numeric(pdb7u0n$donor_pos[x])) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "RBD"}
if(pdb7u0n$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"}}
if(pdb7u0n$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x])-3, as.numeric(pdb7u0n$acceptor_pos[x])-3) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"}}
}
pdb7u0n$donor_res <- paste0(pdb7u0n$donor_aa1,pdb7u0n$donor_pos)
pdb7u0n$acceptor_res <- paste0(pdb7u0n$acceptor_aa1,pdb7u0n$acceptor_pos)
pdb7u0n_inter <- pdb7u0n %>% filter(donor_prot != acceptor_prot & !(donor_res %in% wrong_interhbond_assignments)) %>% mutate(variant = "Beta", pdb = "7u0n")
View(pdb7u0n_inter)
substr(temp_rbd_seq490,493)
substr(temp_rbd_seq490,493)
substr(temp_rbd_seq,490,493)
View(pdb7u0n)
View(pdb7w9i)
View(pdb7vx4)
View(pdb7ekg)
View(pdb7u0n_inter)
pdb7u0n <- read.csv(file = "Data/Proteintools/Proteintools_7u0n.csv")
for(x in 1:nrow(pdb7u0n)){
temp_rbd_seq <- subset(proteintools_key, pdb == "7u0n")$sequence
pdb7u0n$donor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][1],"-")[[1]][1]
pdb7u0n$acceptor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][2],"-")[[1]][1]
pdb7u0n$donor_aa3[x] <-  substr(pdb7u0n$donor[x],1,3)
pdb7u0n$donor_pos[x] <-  substr(pdb7u0n$donor[x],4,6)
pdb7u0n$acceptor_aa3[x] <-  substr(pdb7u0n$acceptor[x],2,4)
pdb7u0n$acceptor_pos[x] <-  substr(pdb7u0n$acceptor[x],5,7)
pdb7u0n$donor_aa1[x] <-  to_single_notation(pdb7u0n$donor_aa3[x])
pdb7u0n$acceptor_aa1[x] <-  to_single_notation(pdb7u0n$acceptor_aa3[x])
if(substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7u0n$donor_pos[x]), as.numeric(pdb7u0n$donor_pos[x])) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "ACE2"}
if(pdb7u0n$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"}}
if(pdb7u0n$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x])-3, as.numeric(pdb7u0n$acceptor_pos[x])-3) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"}}
}
pdb7u0n$donor_res <- paste0(pdb7u0n$donor_aa1,pdb7u0n$donor_pos)
pdb7u0n$acceptor_res <- paste0(pdb7u0n$acceptor_aa1,pdb7u0n$acceptor_pos)
pdb7u0n_inter <- pdb7u0n %>% filter(donor_prot != acceptor_prot & !(donor_res %in% wrong_interhbond_assignments)) %>% mutate(variant = "Beta", pdb = "7u0n")
View(pdb7u0n_inter)
pdb7u0n <- read.csv(file = "Data/Proteintools/Proteintools_7u0n.csv")
for(x in 1:nrow(pdb7u0n)){
temp_rbd_seq <- subset(proteintools_key, pdb == "7u0n")$sequence
pdb7u0n$donor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][1],"-")[[1]][1]
pdb7u0n$acceptor[x] <- strsplit(strsplit(pdb7u0n$donor_acceptor[x], "--")[[1]][2],"-")[[1]][1]
pdb7u0n$donor_aa3[x] <-  substr(pdb7u0n$donor[x],1,3)
pdb7u0n$donor_pos[x] <-  substr(pdb7u0n$donor[x],4,6)
pdb7u0n$acceptor_aa3[x] <-  substr(pdb7u0n$acceptor[x],2,4)
pdb7u0n$acceptor_pos[x] <-  substr(pdb7u0n$acceptor[x],5,7)
pdb7u0n$donor_aa1[x] <-  to_single_notation(pdb7u0n$donor_aa3[x])
pdb7u0n$acceptor_aa1[x] <-  to_single_notation(pdb7u0n$acceptor_aa3[x])
if(substr(temp_ace2_seq, as.numeric(pdb7u0n$donor_pos[x]), as.numeric(pdb7u0n$donor_pos[x])) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$donor_pos[x])-3, as.numeric(pdb7u0n$donor_pos[x])-3) == pdb7u0n$donor_aa1[x]){pdb7u0n$donor_prot[x] <- "RBD"}
if(pdb7u0n$donor_prot[x] == "ACE2"){if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"} else if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"}}
if(pdb7u0n$donor_prot[x] == "RBD"){if(substr(temp_rbd_seq, as.numeric(pdb7u0n$acceptor_pos[x])-3, as.numeric(pdb7u0n$acceptor_pos[x])-3) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "RBD"} else if(substr(temp_ace2_seq, as.numeric(pdb7u0n$acceptor_pos[x]), as.numeric(pdb7u0n$acceptor_pos[x])) == pdb7u0n$acceptor_aa1[x]){pdb7u0n$acceptor_prot[x] <- "ACE2"}}
}
pdb7u0n$donor_res <- paste0(pdb7u0n$donor_aa1,pdb7u0n$donor_pos)
pdb7u0n$acceptor_res <- paste0(pdb7u0n$acceptor_aa1,pdb7u0n$acceptor_pos)
pdb7u0n_inter <- pdb7u0n %>% filter(donor_prot != acceptor_prot & !(donor_res %in% wrong_interhbond_assignments)) %>% mutate(variant = "Beta", pdb = "7u0n")
View(pdb7u0n)
va_rep1 <- read.csv(file = "Data/Vif_apobec/Vif_apobec_rep1.csv", header = T)
View(va_rep1)
va_rep1 <- read.csv(file = "Data/Vif_apobec/Vif_apobec_rep1.csv", header = T)
View(va_rep1)
View(va_rep1)
va_rep1 <- read.csv(file = "Data/Vif_apobec/Vif_apobec_rep1.csv", header = T)
va_rep1 <- read.csv(file = "Data/Vif_apobec/Vif_apobec_rep1.csv", header = T, row.names = T)
View(va_rep1)
melt(va_rep1)
library(reshape)
melt(va_rep1)
va_rep1 <- read.csv(file = "Data/Vif_apobec/Vif_apobec_rep1.csv", header = T)
melt(va_rep1)
va_rep1[x,y] <- va_rep1[x,y] / va_rep1[6,y]
for(x in 1:nrow(va_rep1)){
for(y in 1:ncol(va_rep1)){
va_rep1[x,y] <- va_rep1[x,y] / va_rep1[6,y]
}
}
va_rep1[x,y]
va_rep1[x,y]
va_rep1 <- read.csv(file = "Data/Vif_apobec/Vif_apobec_rep1.csv", header = T)
for(x in 2:nrow(va_rep1)){
for(y in 2:ncol(va_rep1)){
va_rep1[x,y] <- va_rep1[x,y] / va_rep1[6,y]
}
}
View(va_rep1)
View(va_rep1)
va_rep1 <- read.csv(file = "Data/Vif_apobec/Vif_apobec_rep1.csv", header = T)
View(va_rep1)
va_rep1[6,y]
va_rep1[6,y]
View(va_rep1)
va_rep1 <- read.csv(file = "Data/Vif_apobec/Vif_apobec_rep1.csv", header = T)
for(x in 2:nrow(va_rep1)){
for(y in 2:ncol(va_rep1)){
va_rep1[x,y] <- va_rep1[x,y] / va_rep1[6,y]
}
}
View(va_rep1)
va_rep1[6,y]
va_rep1 <- read.csv(file = "Data/Vif_apobec/Vif_apobec_rep1.csv", header = T)
for(x in 1:nrow(va_rep1)){
for(y in 2:ncol(va_rep1)){
va_rep1[x,y] <- va_rep1[x,y] / va_rep1[6,y]
}
}
View(va_rep1)
View(va_rep1)
va_rep1_melt <- melt(va_rep1)
View(va_rep1_melt)
colnames(va_rep1_melt) <- c("vif","apobec","normalized")
ggplot() + geom_tile(data = va_rep1, aes(x = apobec, y = vif, fill = normalized))
library(tidyverse)
ggplot() + geom_tile(data = va_rep1, aes(x = apobec, y = vif, fill = normalized))
ggplot() + geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient(low = "red",high = "white") +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradientn(low = "red",mid = "white", high = "green") +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red",mid = "white", high = "green") +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient(low = "red",high = "white") +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
View(va_rep1_melt)
View(va_rep1_melt)
ggplot() + scale_fill_gradient(low = "red",high = "white", na.value = "white", limits = c(0.25,1.3)) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient(low = "red",high = "white", na.value = "white", limits = c(0.25,1)) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient(low = "red",high = "white", na.value = "white", limits = c(0.25,1.1)) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient(low = "red",mid = "white", high = "blue", na.value = "white", limits = c(0.25,1.1), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "white", limits = c(0.25,1.1), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "white", limits = c(0.25,1.6), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "white", limits = c(0.25,1.7), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "white", limits = c(0.25,1.2), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "grey50", limits = c(0.25,1.2), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "grey50", limits = c(0.25,1.25), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "grey50", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "purple", na.value = "grey50", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "lightpurple", na.value = "orchid", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "orchid", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "cornflowerblue", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "blueviolet", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
va_rep1_melt$vif <- factor(va_rep1_melt$vif, levels = c("WT","STOP","A149Y","W11A","F39A","H43E"))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "blueviolet", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
va_rep1_melt$vif <- factor(va_rep1_melt$vif, levels = rev(c("WT","STOP","A149Y","W11A","F39A","H43E")))
ggplot() + scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "blueviolet", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + theme_bw() +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "blueviolet", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 vif variant") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "blueviolet", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
va_rep1_melt$apobec <- factor(va_rep1_melt$apobec, levels = rev(c("EGFP","A3G.EGFP","EGFP.A3D","EGFP.A3F","EGFP.A3H2")))
va_rep1_melt$vif <- factor(va_rep1_melt$vif, levels = rev(c("WT","STOP","A149Y","W11A","F39A","H43E")))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 vif variant") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "blueviolet", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
va_rep1_melt$apobec <- factor(va_rep1_melt$apobec, levels = c("EGFP","A3G.EGFP","EGFP.A3D","EGFP.A3F","EGFP.A3H2"))
va_rep1_melt$vif <- factor(va_rep1_melt$vif, levels = rev(c("WT","STOP","A149Y","W11A","F39A","H43E")))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 vif variant") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "blueviolet", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 vif variant") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "#CF78FF", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 vif variant") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "#BF80FF", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
scale_fill_gradient2(low = "red", mid = "white", high = "blue", na.value = "#BF80FF", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
scale_fill_gradient2(low = "blue", mid = "white", high = "red", na.value = "pink", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
scale_fill_gradient2(low = "white", mid = "green", high = "red", na.value = "pink", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "pink", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = normalized))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
#scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = log10(normalized)))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
#scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(log10(0.25),log10(1.3)), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = log10(normalized)))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
#scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
scale_fill_gradient2(low = "white", mid = "green3", high = "red", na.value = "green4", limits = c(log10(0.25),log10(1.3)), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = log10(normalized)))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
#scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
scale_fill_gradient2(low = "white", mid = "green4", high = "red", na.value = "green4", limits = c(log10(0.25),log10(1.3)), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = log10(normalized)))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
#scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
scale_fill_gradient2(low = "white", mid = "green4", high = "red", na.value = "green3", limits = c(log10(0.25),log10(1.3)), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = log10(normalized)))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
#scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
scale_fill_gradient2(low = "white", mid = "green4", high = "red", na.value = "green4", limits = c(log10(0.25),log10(1.3)), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = log10(normalized)))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
#scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
scale_fill_gradient2(low = "white", mid = "green4", high = "red", na.value = "green2", limits = c(log10(0.25),log10(1.3)), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = log10(normalized)))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
#scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
scale_fill_gradient2(low = "white", mid = "green4", high = "red", na.value = "forestgreen", limits = c(log10(0.25),log10(1.3)), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = log10(normalized)))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
#scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
scale_fill_gradient2(low = "white", mid = "green4", high = "red", na.value = "green4", limits = c(log10(0.25),log10(1.3)), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = log10(normalized)))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
#scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "green4", limits = c(log10(0.25),log10(1.3)), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = log10(normalized)))
ggplot() + theme_bw() +
labs(x = "EGFP or Apobec fusion", y = "HIV-1 Vif variant") +
#scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "brown4", limits = c(0.25,1.3), midpoint = 1) +
scale_fill_gradient2(low = "white", mid = "darkgreen", high = "red", na.value = "green4", limits = c(log2(0.25),log2(1.3)), midpoint = 1) +
geom_tile(data = va_rep1_melt, aes(x = apobec, y = vif, fill = log2(normalized)))
